<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secondary Hypertension - Match Properties</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e27;
            background-image: 
                radial-gradient(at 20% 30%, rgba(120, 119, 198, 0.15) 0px, transparent 50%),
                radial-gradient(at 80% 70%, rgba(99, 102, 241, 0.15) 0px, transparent 50%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #1a1f3a 0%, #2d1b3d 100%);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        h1 {
            background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 700;
        }

        .subtitle {
            color: #a0a0b0;
            font-size: 1.1em;
        }

        .score-board {
            background: linear-gradient(135deg, #1a1f3a 0%, #2d1b3d 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .score-item {
            text-align: center;
        }

        .score-label {
            color: #a0a0b0;
            font-size: 0.9em;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .score-value {
            font-size: 2em;
            font-weight: bold;
            background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .game-area {
            background: linear-gradient(135deg, #1a1f3a 0%, #2d1b3d 100%);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .instruction {
            background: rgba(99, 102, 241, 0.15);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #818cf8;
            color: #e0e0e0;
        }

        .main-content {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .word-banks {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            flex: 0 0 350px;
            position: sticky;
            top: 20px;
            align-self: flex-start;
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }

        .table-area {
            flex: 1;
            min-width: 0;
        }

        .word-banks-title {
            background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .tabs {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }

        .tab {
            padding: 10px 16px;
            background: rgba(30, 35, 60, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            color: #a0a0b0;
            transition: all 0.3s ease;
            text-align: center;
        }

        .tab.active {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 -5px 20px rgba(99, 102, 241, 0.3);
        }

        .tab:hover:not(.active) {
            background: rgba(99, 102, 241, 0.2);
            color: #c084fc;
            border-color: rgba(99, 102, 241, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .word-bank-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            background: rgba(10, 14, 39, 0.5);
            border-radius: 8px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            max-height: 60vh;
            overflow-y: auto;
        }

        .word-card {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            cursor: move;
            font-size: 0.9em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .word-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(99, 102, 241, 0.5);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .word-card.dragging {
            opacity: 0.5;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
            border-radius: 10px;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(10, 14, 39, 0.5);
        }

        th {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: bold;
            border: 2px solid rgba(99, 102, 241, 0.3);
            font-size: 0.95em;
        }

        td {
            padding: 12px 10px;
            border: 2px solid rgba(99, 102, 241, 0.15);
            vertical-align: top;
            font-size: 0.9em;
            background: rgba(26, 31, 58, 0.5);
        }

        .cause-name {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 12px;
            border-radius: 6px;
            font-weight: bold;
            text-align: center;
            font-size: 0.95em;
            box-shadow: 0 2px 10px rgba(99, 102, 241, 0.3);
        }

        .drop-zone {
            min-height: 70px;
            border: 2px dashed rgba(99, 102, 241, 0.3);
            border-radius: 6px;
            padding: 8px;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.2);
        }

        .drop-zone.drag-over {
            background: rgba(99, 102, 241, 0.2);
            border-color: #818cf8;
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
        }

        .dropped-item {
            background: rgba(30, 35, 60, 0.8);
            padding: 8px 10px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85em;
            margin-bottom: 5px;
            line-height: 1.4;
            border: 2px solid rgba(99, 102, 241, 0.3);
            color: #e0e0e0;
        }

        .dropped-item:last-child {
            margin-bottom: 0;
        }

        .dropped-item.correct {
            background: rgba(16, 185, 129, 0.15);
            border: 2px solid #10b981;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
        }

        .dropped-item.incorrect {
            background: rgba(239, 68, 68, 0.15);
            border: 2px solid #ef4444;
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.3);
        }

        .remove-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75em;
            transition: all 0.3s ease;
            flex-shrink: 0;
            margin-left: 8px;
        }

        .remove-btn:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            box-shadow: 0 2px 10px rgba(239, 68, 68, 0.4);
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(99, 102, 241, 0.6);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
        }

        .btn-secondary:hover {
            box-shadow: 0 6px 25px rgba(236, 72, 153, 0.6);
        }

        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #1a1f3a 0%, #2d1b3d 100%);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            text-align: center;
            z-index: 1000;
            transition: all 0.3s ease;
            max-width: 500px;
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        .feedback.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .feedback h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .feedback p {
            color: #a0a0b0;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            z-index: 999;
            backdrop-filter: blur(5px);
        }

        .overlay.show {
            display: block;
        }

        @media (max-width: 1200px) {
            .main-content {
                flex-direction: column;
            }

            .word-banks {
                flex: 1;
                position: relative;
                max-height: none;
            }

            .word-bank-container {
                max-height: 40vh;
            }

            table {
                font-size: 0.8em;
            }
            
            th, td {
                padding: 8px 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ©º Secondary Hypertension Causes</h1>
            <p class="subtitle">Match each cause with its pathophysiology and diagnostic clues</p>
        </div>

        <div class="score-board">
            <div class="score-item">
                <div class="score-label">Total Placed</div>
                <div class="score-value" id="placed-score">0/16</div>
            </div>
            <div class="score-item">
                <div class="score-label">Correct</div>
                <div class="score-value" id="correct-score">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">Incorrect</div>
                <div class="score-value" id="incorrect-score" style="color: #ef4444;">0</div>
            </div>
        </div>

        <div class="game-area">
            <div class="instruction">
                <strong>Instructions:</strong> Use the tabs below to access Pathophysiology and Diagnostic Clues. Drag items from the word bank on the left into the appropriate cells in the table. Each cause needs both properties matched correctly!
            </div>

            <div class="main-content">
                <div class="word-banks">
                    <div class="word-banks-title">ðŸ“š Word Banks</div>
                    
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('pathophysiology')">Pathophysiology</button>
                        <button class="tab" onclick="switchTab('diagnostic')">Diagnostic Clues</button>
                    </div>

                    <div id="tab-pathophysiology" class="tab-content active">
                        <div class="word-bank-container" id="pathophysiology-bank"></div>
                    </div>
                    <div id="tab-diagnostic" class="tab-content">
                        <div class="word-bank-container" id="diagnostic-bank"></div>
                    </div>
                </div>

                <div class="table-area">
                    <div class="table-container">
                        <table id="game-table">
                            <thead>
                                <tr>
                                    <th style="width: 25%;">Cause</th>
                                    <th style="width: 38%;">Pathophysiology</th>
                                    <th style="width: 37%;">Diagnostic Clues</th>
                                </tr>
                            </thead>
                            <tbody id="table-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn" onclick="checkAnswers()">Show Summary</button>
                <button class="btn btn-secondary" onclick="resetGame()">Reset Game</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="feedback" id="feedback"></div>

    <script>
        const causes = [
            {
                name: "Chronic kidney disease (CKD)",
                pathophysiology: "â†‘ Tubular Na reabsorption or activated renin-angiotensin-aldosterone system (RAAS)",
                diagnostic: "â†‘ Blood urea nitrogen (BUN) and creatinine, proteinuria, hematuria"
            },
            {
                name: "Renal artery stenosis",
                pathophysiology: "â†“ Renal blood flow activates RAAS",
                diagnostic: "Abdominal bruit; history of atherosclerosis"
            },
            {
                name: "Hyperaldosteronism",
                pathophysiology: "â†‘ Tubular sodium reabsorption",
                diagnostic: "Hypokalemia"
            },
            {
                name: "Hypercortisolism",
                pathophysiology: "â†‘ Tubular sodium reabsorption upregulates angiotensin II receptors and potentiates effects of catecholamines",
                diagnostic: "Cushingoid physical findings; measure 24-hour urine cortisol"
            },
            {
                name: "Thyroid disorders",
                pathophysiology: "Hyperthyroidism increases cardiac output\nHypothyroidism increases vascular resistance",
                diagnostic: "Hyperthyroid: increased pulse, weight loss\nHypothyroid: depression, constipation, weight gain\nMeasure thyroid stimulating hormone"
            },
            {
                name: "Pheochromocytoma",
                pathophysiology: "â†‘ Catecholamines",
                diagnostic: "Episodic palpitation, tremor; measure plasma or 24-hour urine metanephrines"
            },
            {
                name: "Congenital adrenal hyperplasia",
                pathophysiology: "â†‘ Mineralocorticoids, â†‘ tubular sodium reabsorption",
                diagnostic: "Children, reproductive or pubertal abnormalities"
            },
            {
                name: "Obstructive sleep apnea",
                pathophysiology: "Hypoxia increases sympathetic tone, which increases systemic vascular resistance (SVR)",
                diagnostic: "Obese patients with excess neck soft tissue, snoring, daytime fatigue; perform polysomnography"
            }
        ];

        let gameState = {
            correct: 0,
            incorrect: 0,
            placed: 0
        };

        // Shuffle array function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function initGame() {
            renderWordBanks();
            renderTable();
            updateScore();
        }

        function renderWordBanks() {
            const pathophysiologyBank = document.getElementById('pathophysiology-bank');
            const diagnosticBank = document.getElementById('diagnostic-bank');

            pathophysiologyBank.innerHTML = '';
            diagnosticBank.innerHTML = '';

            // Create arrays for each type
            const pathophysiologyItems = [];
            const diagnosticItems = [];

            causes.forEach((cause, index) => {
                pathophysiologyItems.push({ text: cause.pathophysiology, type: 'pathophysiology', index });
                diagnosticItems.push({ text: cause.diagnostic, type: 'diagnostic', index });
            });

            // Shuffle each array
            const shuffledPathophysiology = shuffleArray(pathophysiologyItems);
            const shuffledDiagnostic = shuffleArray(diagnosticItems);

            // Render shuffled items
            shuffledPathophysiology.forEach(item => {
                pathophysiologyBank.appendChild(createWordCard(item.text, item.type, item.index));
            });

            shuffledDiagnostic.forEach(item => {
                diagnosticBank.appendChild(createWordCard(item.text, item.type, item.index));
            });
        }

        function createWordCard(text, type, causeIndex) {
            const card = document.createElement('div');
            card.className = 'word-card';
            card.draggable = true;
            card.textContent = text;
            card.dataset.text = text;
            card.dataset.type = type;
            card.dataset.causeIndex = causeIndex;
            
            card.addEventListener('dragstart', handleDragStart);
            card.addEventListener('dragend', handleDragEnd);
            
            return card;
        }

        function renderTable() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';
            
            causes.forEach((cause, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>
                        <div class="cause-name">${cause.name}</div>
                    </td>
                    <td>
                        <div class="drop-zone" 
                             data-type="pathophysiology" 
                             data-cause-index="${index}"
                             data-correct="${cause.pathophysiology}"></div>
                    </td>
                    <td>
                        <div class="drop-zone" 
                             data-type="diagnostic" 
                             data-cause-index="${index}"
                             data-correct="${cause.diagnostic}"></div>
                    </td>
                `;
                
                tbody.appendChild(row);
                
                // Add drag and drop listeners to drop zones
                row.querySelectorAll('.drop-zone').forEach(zone => {
                    zone.addEventListener('dragover', handleDragOver);
                    zone.addEventListener('drop', handleDrop);
                    zone.addEventListener('dragleave', handleDragLeave);
                });
            });
        }

        function handleDragStart(e) {
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text', e.target.dataset.text);
            e.dataTransfer.setData('type', e.target.dataset.type);
            e.dataTransfer.setData('causeIndex', e.target.dataset.causeIndex);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            e.target.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.target.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target.classList.contains('drop-zone') ? e.target : e.target.closest('.drop-zone');
            dropZone.classList.remove('drag-over');
            
            const text = e.dataTransfer.getData('text');
            const type = e.dataTransfer.getData('type');
            const causeIndex = e.dataTransfer.getData('causeIndex');
            
            // Check if types match
            if (dropZone.dataset.type !== type) {
                return;
            }
            
            // Check if already filled
            if (dropZone.querySelector('.dropped-item')) {
                return;
            }
            
            // Remove from word bank
            const wordCard = document.querySelector(`.word-card[data-text="${text}"][data-type="${type}"]`);
            if (wordCard) {
                wordCard.remove();
            }
            
            // Check if correct
            const correctText = dropZone.dataset.correct;
            const isCorrect = text === correctText;
            
            // Add to drop zone
            const droppedItem = document.createElement('div');
            droppedItem.className = `dropped-item ${isCorrect ? 'correct' : 'incorrect'}`;
            droppedItem.dataset.text = text;
            droppedItem.dataset.type = type;
            droppedItem.dataset.causeIndex = causeIndex;
            droppedItem.innerHTML = `
                <span>${text}</span>
                <button class="remove-btn" onclick="removeItem('${text.replace(/'/g, "\\'")}', '${type}', ${causeIndex})">âœ•</button>
            `;
            
            dropZone.appendChild(droppedItem);
            
            updateScore();
        }

        function removeItem(text, type, causeIndex) {
            // Find and remove from table
            const droppedItem = document.querySelector(`.dropped-item[data-text="${text}"][data-type="${type}"]`);
            if (droppedItem) {
                droppedItem.classList.remove('correct', 'incorrect');
                droppedItem.remove();
            }
            
            // Add back to appropriate word bank
            const bankId = `${type}-bank`;
            const bank = document.getElementById(bankId);
            const card = createWordCard(text, type, causeIndex);
            bank.appendChild(card);
            
            updateScore();
        }

        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        function updateScore() {
            const placed = document.querySelectorAll('.dropped-item').length;
            const correct = document.querySelectorAll('.dropped-item.correct').length;
            const incorrect = document.querySelectorAll('.dropped-item.incorrect').length;
            
            gameState.placed = placed;
            gameState.correct = correct;
            gameState.incorrect = incorrect;
            
            document.getElementById('placed-score').textContent = `${placed}/16`;
            document.getElementById('correct-score').textContent = correct;
            document.getElementById('incorrect-score').textContent = incorrect;
            
            // Auto-show completion feedback
            if (placed === 16) {
                setTimeout(() => {
                    if (incorrect === 0) {
                        showFeedback('ðŸŽ‰ Perfect Score!', `You correctly matched all 16 properties! You've mastered secondary hypertension causes!`);
                    } else {
                        showFeedback('Table Complete!', `You got ${correct} out of 16 correct (${Math.round(correct/16*100)}%). Review the red entries and fix them!`);
                    }
                }, 300);
            }
        }

        function checkAnswers() {
            const placed = gameState.placed;
            const correct = gameState.correct;
            const incorrect = gameState.incorrect;
            
            if (placed === 0) {
                showFeedback('No Items Placed', 'Start dragging items from the word banks to fill in the table!');
            } else if (placed === 16) {
                if (incorrect === 0) {
                    showFeedback('ðŸŽ‰ Perfect Score!', `All 16 properties are correctly matched! Excellent work!`);
                } else {
                    showFeedback('Review Needed', `You have ${correct} correct and ${incorrect} incorrect. Remove the red items and try again!`);
                }
            } else {
                showFeedback('Progress Report', `Current progress: ${correct} correct, ${incorrect} incorrect. ${16 - placed} items remaining!`);
            }
        }

        function showFeedback(title, message) {
            const feedback = document.getElementById('feedback');
            const overlay = document.getElementById('overlay');
            
            feedback.innerHTML = `
                <h2>${title}</h2>
                <p style="font-size: 1.1em; color: #a0a0b0; margin-bottom: 20px;">${message}</p>
                <button class="btn" onclick="closeFeedback()">Continue</button>
            `;
            
            overlay.classList.add('show');
            setTimeout(() => feedback.classList.add('show'), 10);
        }

        function closeFeedback() {
            document.getElementById('feedback').classList.remove('show');
            document.getElementById('overlay').classList.remove('show');
        }

        function resetGame() {
            // Clear all drop zones
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.innerHTML = '';
            });
            
            // Reset scores
            gameState = { correct: 0, incorrect: 0, placed: 0 };
            document.getElementById('placed-score').textContent = '0/16';
            document.getElementById('correct-score').textContent = 0;
            document.getElementById('incorrect-score').textContent = 0;
            
            // Re-render word banks
            renderWordBanks();
            
            closeFeedback();
        }

        // Initialize game on load
        initGame();
    </script>
</body>
</html>
