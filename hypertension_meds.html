<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antihypertensive Medications - Drag & Drop Study Game</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e4e4e4;
            padding: 20px;
            min-height: 100vh;
        }
        .container { max-width: 1600px; margin: 0 auto; }
        h1 {
            text-align: center;
            color: #00d9ff;
            margin-bottom: 10px;
            font-size: 2.2em;
            text-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
        }
        .subtitle {
            text-align: center;
            color: #a0a0a0;
            margin-bottom: 25px;
            font-size: 1.1em;
        }
        .stats-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .stats { display: flex; gap: 25px; flex-wrap: wrap; }
        .stat-item {
            background: rgba(0, 217, 255, 0.1);
            padding: 12px 20px;
            border-radius: 8px;
            border: 1px solid rgba(0, 217, 255, 0.3);
        }
        .stat-label { color: #00d9ff; font-weight: bold; margin-right: 8px; }
        .controls { display: flex; gap: 12px; flex-wrap: wrap; }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(240, 147, 251, 0.4);
        }
        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }
        .btn-danger {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: #333;
        }
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(250, 112, 154, 0.4);
        }
        .main-content {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 25px;
            align-items: start;
        }
        .word-bank-container {
            position: sticky;
            top: 20px;
            background: rgba(22, 33, 62, 0.95);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid rgba(0, 217, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }
        .word-bank-title {
            color: #00d9ff;
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            border-bottom: 2px solid rgba(0, 217, 255, 0.3);
        }
        .tab {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: #a0a0a0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            font-weight: 600;
            border-radius: 8px 8px 0 0;
        }
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: #e4e4e4;
        }
        .word-bank {
            min-height: 400px;
            max-height: 70vh;
            overflow-y: auto;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            display: none;
        }
        .word-bank.active { display: block; }
        .word-bank::-webkit-scrollbar { width: 8px; }
        .word-bank::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }
        .word-bank::-webkit-scrollbar-thumb {
            background: rgba(0, 217, 255, 0.5);
            border-radius: 4px;
        }
        .draggable-item {
            background: linear-gradient(135deg, #2d3561 0%, #1f2847 100%);
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: move;
            border: 2px solid rgba(0, 217, 255, 0.4);
            transition: all 0.3s ease;
            font-size: 0.95em;
            line-height: 1.4;
        }
        .draggable-item:hover {
            background: linear-gradient(135deg, #3d4571 0%, #2f3857 100%);
            border-color: #00d9ff;
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0, 217, 255, 0.3);
        }
        .draggable-item.dragging { opacity: 0.5; transform: rotate(2deg); }
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(480px, 1fr));
            gap: 20px;
        }
        .drug-card {
            background: rgba(22, 33, 62, 0.95);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid rgba(0, 217, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }
        .drug-card-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        .drop-zones { display: grid; gap: 12px; }
        .drop-row {
            display: grid;
            grid-template-columns: 140px 1fr;
            gap: 10px;
            align-items: start;
        }
        .drop-label {
            background: rgba(0, 217, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
            font-weight: 600;
            color: #00d9ff;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            border: 1px solid rgba(0, 217, 255, 0.3);
        }
        .drop-zone {
            min-height: 60px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px dashed rgba(0, 217, 255, 0.3);
            border-radius: 8px;
            padding: 10px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .drop-zone.drag-over {
            background: rgba(0, 217, 255, 0.2);
            border-color: #00d9ff;
            border-style: solid;
            box-shadow: 0 0 20px rgba(0, 217, 255, 0.3);
        }
        .dropped-item {
            background: linear-gradient(135deg, #2d3561 0%, #1f2847 100%);
            padding: 10px 12px;
            border-radius: 6px;
            cursor: move;
            border: 2px solid rgba(0, 217, 255, 0.4);
            transition: all 0.3s ease;
            font-size: 0.9em;
            line-height: 1.4;
        }
        .dropped-item:hover {
            background: linear-gradient(135deg, #3d4571 0%, #2f3857 100%);
            border-color: #00d9ff;
        }
        .dropped-item.correct {
            background: linear-gradient(135deg, #0f9b0f 0%, #0a7c0a 100%);
            border-color: #00ff00;
            animation: correctPulse 0.5s ease;
        }
        .dropped-item.incorrect {
            background: linear-gradient(135deg, #c41e3a 0%, #9a1829 100%);
            border-color: #ff4444;
            animation: incorrectShake 0.5s ease;
        }
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(0, 255, 0, 0.5); }
        }
        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .summary-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .summary-modal.active { display: flex; }
        .summary-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 12px;
            padding: 30px;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid rgba(0, 217, 255, 0.5);
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.8);
        }
        .summary-content::-webkit-scrollbar { width: 10px; }
        .summary-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }
        .summary-content::-webkit-scrollbar-thumb {
            background: rgba(0, 217, 255, 0.5);
            border-radius: 5px;
        }
        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 217, 255, 0.3);
        }
        .summary-title {
            color: #00d9ff;
            font-size: 1.8em;
            font-weight: bold;
        }
        .close-btn {
            background: rgba(255, 68, 68, 0.2);
            border: 2px solid #ff4444;
            color: #ff4444;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .close-btn:hover {
            background: #ff4444;
            color: white;
        }
        .summary-drug {
            margin-bottom: 25px;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #00d9ff;
        }
        .summary-drug-title {
            color: #00d9ff;
            font-size: 1.3em;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .summary-category { margin-bottom: 12px; }
        .summary-category-title {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 1.05em;
        }
        .summary-category-content {
            color: #e4e4e4;
            padding-left: 15px;
            line-height: 1.6;
        }
        @media (max-width: 1200px) {
            .main-content { grid-template-columns: 1fr; }
            .word-bank-container { position: relative; top: 0; }
            .cards-container { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6em; }
            .stats-controls { flex-direction: column; }
            .stats, .controls { width: 100%; justify-content: center; }
            .btn { flex: 1; min-width: 120px; }
            .drop-row { grid-template-columns: 1fr; }
            .drop-label { text-align: center; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ©º Antihypertensive Medications</h1>
        <p class="subtitle">Drag and drop items from the word bank to match each medication class</p>
        <div class="stats-controls">
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-label">Score:</span>
                    <span id="score">0</span>/<span id="total">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Remaining:</span>
                    <span id="remaining">0</span>
                </div>
            </div>
            <div class="controls">
                <button class="btn btn-primary" onclick="showSummary()">ðŸ“‹ Show Summary</button>
                <button class="btn btn-secondary" onclick="showHint()">ðŸ’¡ Hint</button>
                <button class="btn btn-success" onclick="showAllAnswers()">âœ“ Show All Answers</button>
                <button class="btn btn-danger" onclick="resetGame()">ðŸ”„ Reset</button>
            </div>
        </div>
        <div class="main-content">
            <div class="word-bank-container">
                <div class="word-bank-title">ðŸ“š Word Bank</div>
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('mechanism')">Mechanism</button>
                    <button class="tab" onclick="switchTab('examples')">Examples</button>
                    <button class="tab" onclick="switchTab('adverse')">Adverse Effects</button>
                    <button class="tab" onclick="switchTab('clinical')">Clinical Notes</button>
                </div>
                <div id="mechanism-bank" class="word-bank active"></div>
                <div id="examples-bank" class="word-bank"></div>
                <div id="adverse-bank" class="word-bank"></div>
                <div id="clinical-bank" class="word-bank"></div>
            </div>
            <div class="cards-container" id="cards-container"></div>
        </div>
    </div>
    <div class="summary-modal" id="summaryModal">
        <div class="summary-content">
            <div class="summary-header">
                <div class="summary-title">ðŸ“– Complete Summary</div>
                <button class="close-btn" onclick="closeSummary()">Close</button>
            </div>
            <div id="summaryContent"></div>
        </div>
    </div>
    <script>
        const gameData = {
            "CCBs (Calcium Channel Blockers)": {
                mechanism: "Block CaÂ²âº entry â†’ relax smooth muscle â†’ decrease SVR â†’ lower BP",
                examples: "DHPs: Nifedipine, Amlodipine, Felodipine | Non-DHPs: Verapamil, Diltiazem",
                adverse: "Peripheral edema, reflex tachycardia (DHPs), constipation (verapamil), headache, flushing",
                clinical: "DHPs used for angina and hypertension. Reflex tachycardia risky in ischemic heart disease."
            },
            "Thiazide-type Diuretics": {
                mechanism: "Block Na-Cl symporter in DCT â†’ increase Na/K/Cl/water excretion â†’ decrease volume â†’ lower BP",
                examples: "Chlorthalidone, Hydrochlorothiazide, Indapamide, Metolazone",
                adverse: "Hypokalemia, hyponatremia, hyperuricemia, photosensitivity",
                clinical: "First-line for Stage 1 hypertension. Often combined with ACEi/ARBs/CCBs."
            },
            "ACE Inhibitors (ACEi)": {
                mechanism: "Block ACE â†’ prevent Ang I to Ang II conversion â†’ decrease SVR â†’ lower BP",
                examples: "Ramipril, Lisinopril, Enalapril (-pril suffix)",
                adverse: "Dry cough (bradykinin), hyperkalemia, angioedema, teratogenic",
                clinical: "Used in hypertension with proteinuria (dilate efferent arteriole). Monitor Kâº. Avoid in pregnancy."
            },
            "ARBs (Angiotensin Receptor Blockers)": {
                mechanism: "Block Ang-II at AT1 receptor â†’ decrease SVR â†’ increase natriuresis â†’ lower BP",
                examples: "Losartan, Valsartan (-sartan suffix)",
                adverse: "Hyperkalemia, angioedema (more than ACEi), teratogenic. NO dry cough.",
                clinical: "Like ACEi but no cough. Used in proteinuria. Monitor Kâº. Avoid NSAIDs, K-sparing diuretics, pregnancy."
            },
            "Î±1-Adrenergic Blockers": {
                mechanism: "Block Î±1-receptors â†’ decrease vasoconstriction â†’ relax arterial/venous smooth muscle â†’ lower BP",
                examples: "Prazosin, Doxazosin, Terazosin",
                adverse: "Orthostatic hypotension (high risk in elderly, first dose), priapism, reflex tachycardia",
                clinical: "Not first-line due to OH risk. Require slow titration. Avoid with nitrates/PDE-5 inhibitors."
            },
            "Clonidine (Î±2-Agonist)": {
                mechanism: "Central Î±2 agonist â†’ inhibit sympathetic outflow â†’ decrease peripheral resistance â†’ lower BP",
                examples: "Clonidine",
                adverse: "Sedation, dry mouth, constipation",
                clinical: "Last-line for resistant hypertension (not responding to 2+ drugs). Acts centrally."
            },
            "Î²-Blockers": {
                mechanism: "Block Î²1 receptors â†’ decrease HR and contractility â†’ decrease cardiac output â†’ lower BP. Also decrease renin.",
                examples: "Î²1-selective: Metoprolol | Non-selective: Propranolol | Mixed Î±/Î²: Labetalol",
                adverse: "Fatigue, dizziness, bronchospasm (non-selective), mask hypoglycemia",
                clinical: "Not first-line. Useful with coronary disease or heart failure. Non-selective worsen asthma."
            },
            "Minoxidil": {
                mechanism: "Opens Kâº channels in vascular smooth muscle â†’ stabilize membrane â†’ decrease vasoconstriction â†’ lower BP",
                examples: "Minoxidil",
                adverse: "Headache, sweating, hypertrichosis (hair growth), tachycardia (baroreceptor reflex)",
                clinical: "Reserved for resistant hypertension. Often needs Î²-blocker to prevent reflex tachycardia."
            }
        };
        let score = 0;
        let totalItems = 0;
        let currentTab = 'mechanism';
        let draggedElement = null;
        let allItems = [];

        function initGame() {
            const cardsContainer = document.getElementById('cards-container');
            cardsContainer.innerHTML = '';
            allItems = {
                mechanism: [],
                examples: [],
                adverse: [],
                clinical: []
            };
            Object.keys(gameData).forEach(drug => {
                allItems.mechanism.push({ text: gameData[drug].mechanism, drug, category: 'mechanism' });
                allItems.examples.push({ text: gameData[drug].examples, drug, category: 'examples' });
                allItems.adverse.push({ text: gameData[drug].adverse, drug, category: 'adverse' });
                allItems.clinical.push({ text: gameData[drug].clinical, drug, category: 'clinical' });
            });
            Object.keys(allItems).forEach(category => {
                allItems[category] = shuffleArray(allItems[category]);
            });
            totalItems = Object.keys(gameData).length * 4;
            Object.keys(gameData).forEach(drug => {
                const card = document.createElement('div');
                card.className = 'drug-card';
                card.innerHTML = `
                    <div class="drug-card-title">${drug}</div>
                    <div class="drop-zones">
                        <div class="drop-row">
                            <div class="drop-label">Mechanism</div>
                            <div class="drop-zone" data-drug="${drug}" data-category="mechanism"></div>
                        </div>
                        <div class="drop-row">
                            <div class="drop-label">Examples</div>
                            <div class="drop-zone" data-drug="${drug}" data-category="examples"></div>
                        </div>
                        <div class="drop-row">
                            <div class="drop-label">Adverse Effects</div>
                            <div class="drop-zone" data-drug="${drug}" data-category="adverse"></div>
                        </div>
                        <div class="drop-row">
                            <div class="drop-label">Clinical Notes</div>
                            <div class="drop-zone" data-drug="${drug}" data-category="clinical"></div>
                        </div>
                    </div>
                `;
                cardsContainer.appendChild(card);
            });
            populateWordBanks();
            setupDragAndDrop();
            updateStats();
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function populateWordBanks() {
            ['mechanism', 'examples', 'adverse', 'clinical'].forEach(category => {
                const bank = document.getElementById(`${category}-bank`);
                bank.innerHTML = '';
                allItems[category].forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'draggable-item';
                    div.draggable = true;
                    div.textContent = item.text;
                    div.dataset.drug = item.drug;
                    div.dataset.category = item.category;
                    div.dataset.id = `${category}-${index}`;
                    bank.appendChild(div);
                });
            });
        }

        function setupDragAndDrop() {
            document.querySelectorAll('.draggable-item, .dropped-item').forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
            });
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragleave', handleDragLeave);
            });
            document.querySelectorAll('.word-bank').forEach(bank => {
                bank.addEventListener('dragover', handleDragOver);
                bank.addEventListener('drop', handleDropToBank);
                bank.addEventListener('dragleave', handleDragLeave);
            });
        }

        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            if (e.target.classList.contains('drop-zone') || e.target.classList.contains('word-bank')) {
                e.target.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            if (e.target.classList.contains('drop-zone') || e.target.classList.contains('word-bank')) {
                e.target.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target.closest('.drop-zone');
            if (!dropZone) return;
            dropZone.classList.remove('drag-over');
            const drugName = dropZone.dataset.drug;
            const category = dropZone.dataset.category;
            const draggedDrug = draggedElement.dataset.drug;
            const draggedCategory = draggedElement.dataset.category;
            if (dropZone.children.length > 0) {
                return;
            }
            if (draggedElement.parentElement.classList.contains('word-bank')) {
                draggedElement.remove();
            } else if (draggedElement.parentElement.classList.contains('drop-zone')) {
                draggedElement.remove();
            }
            const droppedItem = document.createElement('div');
            droppedItem.className = 'dropped-item';
            droppedItem.draggable = true;
            droppedItem.textContent = draggedElement.textContent;
            droppedItem.dataset.drug = draggedDrug;
            droppedItem.dataset.category = draggedCategory;
            droppedItem.dataset.id = draggedElement.dataset.id;
            if (drugName === draggedDrug && category === draggedCategory) {
                droppedItem.classList.add('correct');
                score++;
            } else {
                droppedItem.classList.add('incorrect');
            }
            dropZone.appendChild(droppedItem);
            setupDragAndDrop();
            updateStats();
        }

        function handleDropToBank(e) {
            e.preventDefault();
            const wordBank = e.target.closest('.word-bank');
            if (!wordBank) return;
            wordBank.classList.remove('drag-over');
            if (!draggedElement.classList.contains('dropped-item')) return;
            const category = draggedElement.dataset.category;
            const targetBank = document.getElementById(`${category}-bank`);
            if (draggedElement.classList.contains('correct')) {
                score--;
            }
            draggedElement.remove();
            const newItem = document.createElement('div');
            newItem.className = 'draggable-item';
            newItem.draggable = true;
            newItem.textContent = draggedElement.textContent;
            newItem.dataset.drug = draggedElement.dataset.drug;
            newItem.dataset.category = draggedElement.dataset.category;
            newItem.dataset.id = draggedElement.dataset.id;
            targetBank.insertBefore(newItem, targetBank.firstChild);
            setupDragAndDrop();
            updateStats();
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('total').textContent = totalItems;
            let remainingCount = 0;
            document.querySelectorAll('.word-bank').forEach(bank => {
                remainingCount += bank.querySelectorAll('.draggable-item').length;
            });
            document.getElementById('remaining').textContent = remainingCount;
            if (score === totalItems && totalItems > 0) {
                setTimeout(() => {
                    alert('ðŸŽ‰ Congratulations! You have completed the game with a perfect score!');
                }, 500);
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.word-bank').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(`${tab}-bank`).classList.add('active');
        }

        function showHint() {
            const emptyZones = Array.from(document.querySelectorAll('.drop-zone')).filter(zone => zone.children.length === 0);
            if (emptyZones.length === 0) {
                alert('All zones are filled! Check your answers or reset to try again.');
                return;
            }
            const randomZone = emptyZones[Math.floor(Math.random() * emptyZones.length)];
            const drug = randomZone.dataset.drug;
            const category = randomZone.dataset.category;
            switchTab(category);
            document.querySelectorAll('.tab').forEach(t => {
                if (t.textContent.toLowerCase().includes(category)) {
                    t.click();
                }
            });
            setTimeout(() => {
                const correctItem = Array.from(document.querySelectorAll('.draggable-item')).find(item => 
                    item.dataset.drug === drug && item.dataset.category === category
                );
                if (correctItem) {
                    correctItem.style.animation = 'correctPulse 1s ease 3';
                    correctItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    setTimeout(() => {
                        correctItem.style.animation = '';
                    }, 3000);
                }
            }, 100);
        }

        function showAllAnswers() {
            if (!confirm('This will reveal all correct answers. Continue?')) {
                return;
            }
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.innerHTML = '';
            });
            document.querySelectorAll('.drop-zone').forEach(zone => {
                const drug = zone.dataset.drug;
                const category = zone.dataset.category;
                const correctText = gameData[drug][category];
                const droppedItem = document.createElement('div');
                droppedItem.className = 'dropped-item correct';
                droppedItem.textContent = correctText;
                droppedItem.dataset.drug = drug;
                droppedItem.dataset.category = category;
                zone.appendChild(droppedItem);
            });
            document.querySelectorAll('.word-bank').forEach(bank => {
                bank.innerHTML = '';
            });
            score = totalItems;
            setupDragAndDrop();
            updateStats();
        }

        function showSummary() {
            const summaryContent = document.getElementById('summaryContent');
            summaryContent.innerHTML = '';
            Object.keys(gameData).forEach(drug => {
                const drugDiv = document.createElement('div');
                drugDiv.className = 'summary-drug';
                drugDiv.innerHTML = `
                    <div class="summary-drug-title">${drug}</div>
                    <div class="summary-category">
                        <div class="summary-category-title">Mechanism of Action:</div>
                        <div class="summary-category-content">${gameData[drug].mechanism}</div>
                    </div>
                    <div class="summary-category">
                        <div class="summary-category-title">Examples:</div>
                        <div class="summary-category-content">${gameData[drug].examples}</div>
                    </div>
                    <div class="summary-category">
                        <div class="summary-category-title">Adverse Effects:</div>
                        <div class="summary-category-content">${gameData[drug].adverse}</div>
                    </div>
                    <div class="summary-category">
                        <div class="summary-category-title">Clinical Notes:</div>
                        <div class="summary-category-content">${gameData[drug].clinical}</div>
                    </div>
                `;
                summaryContent.appendChild(drugDiv);
            });
            document.getElementById('summaryModal').classList.add('active');
        }

        function closeSummary() {
            document.getElementById('summaryModal').classList.remove('active');
        }

        function resetGame() {
            if (!confirm('This will reset the entire game. Continue?')) {
                return;
            }
            score = 0;
            initGame();
        }

        window.onload = initGame;

        document.getElementById('summaryModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSummary();
            }
        });
    </script>
</body>
</html>
